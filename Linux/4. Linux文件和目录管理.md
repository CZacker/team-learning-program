# 文件和目录管理

了解并掌握Linux文件和目录，是学好Linux重要的一部分。

对于Linux初学者，常常会对众多的目录感到困惑，如home、usr、etc、bin ...... 这些目录下又会包含许多文件。

本章将带大家深入了解Linux的文件和目录。



## 4.1、Linux目录

​		在Linux中，目录为树状结构。树状目录以 / 为起始，也称为根目录，是Linux文件系统的入口，每一个文件和目录都从这里开始。

​		因为目录繁多，各类软件安装，配置都可能存在混乱的情况。所以产生了FHS（Filesystem Hierarchy Standard）组织。FHS制定了目录规范，什么文件应该放在什么目录。根据FHS标准，Linux目录一般可分为以下四种交互状态：

![image-20210605094409906](./img/image-20210605094409906.png)

static:不可变的

variable:可变的

shareable:可分享的

unshareable:不可分享的



“可共享”文件是指可以存储在一台主机上并在其他主机上使用的文件。“不可共享”文件是指那些不可共享的文件。例如，用户主目录中的文件是可共享的，而设备锁文件不是。

“静态”文件包括二进制文件、库、文档文件和其他未经系统管理员干预不会更改的文件。不可变“文件是非静态的文件。



### 4.1.1 目录详解

在Linux中，常使用 ls 命令来查看目录结构。在当前命令窗口输入

```
ls /
```

则可查看根目录下的目录结构

![image-20210607010501046](img/image-20210607010501046.png)

以下是对这些目录的理解：

* / - 根目录

  Linux文件系统的入口，每一个文件和目录都从这里开始。

* /bin - 基本用户命令二进制文件目录

  包含系统管理员和用户都可以使用的命令

* /etc - 配置文件目录 

  本目录包含所有程序所需的配置文件。“配置文件”是用于控制程序操作的本地文件；它必须是静态的，不能是可执行的二进制文件。

* /boot - 引导文件

  目录包含系统启动过程所需的所有内容，但不包括启动时不需要的配置文件和映射安装程序。

* /dev - 设备文件

  dev 是 Device(设备) 的缩写, 该目录下存放的是 Linux 的外部设备，包括终端设备、USB或连接到系统的任何设备。在 Linux 中访问设备的方式和访问文件的方式是相同的。

* /lib - 库文件

  此目录包含引导系统和运行根文件系统中的命令所需的共享库映像，即位于/bin和/sbin中的二进制文件。这些文件可以被很多程序共享。

* /sbin - 系统二进制文件

  /sbin包含由系统管理员使用的二进制可执行文件。

* /proc - 进程信息文件

  包含系统进程的相关信息。是系统内存的映射

* /opt - 可选择文件

  opitional的意思。用于安装附加应用程序软件包。

* /lost+found

  此目录通常为空，当系统非法关机后，这里就存放了一些文件。

* /srv - 服务器数据文件

  srv代表服务。包含服务器特定服务相关的数据。

* /var - 变量文件

  这个目录下可以找到内容可能增长的文件。

  这包括 - 系统日志文件（/var/log）;包和数据库文件（/var/lib）;电子邮件（/var/mail）;打印队列（/var/spool）;锁文件（/var/lock）;多次重新启动需要的临时文件（/var/tmp）;

* /tmp - 临时文件

  包含系统和用户创建的临时文件。当系统重新启动时，这个目录下的文件都将被删除。

* /home - 用户目录

  所有用户都用home来存储个人文件
  
* /usr - 用户程序目录

  包含二进制文件、库文件、文档和二级程序的源代码。

* /mnt - 挂载目录

  此目录主要是作为挂载点使用。通常包括系统引导后被挂载的文件系统的挂载点

* /media - 可移动媒体设备

  用于挂载可移动设备的临时目录。

  

## 4.2、Linux文件

### 4.2.1、Linux文件类型

Linux文件类型：
1）普通文件(regular file)：就是一般类型的文件，当用 ls -l 查看某个目录时，第一个属性为 ‘-‘ 的文件就是正规文件，或者叫普通文件。正规文件又可分成纯文字文件(ascii)和二进制文件(binary)。纯文本文件是可以通过cat, more, less等工具直接查看内容的，而二进制文件并不能。例如我们用的命令/bin/ls 这就是一个二进制文件。

2）目录(directory)：　Linux 中的目录也是文件，目录文件中保存着该目录下其他文件的 inode 号 和文件名等信息，目录文件中的每个数据项都是指向某个文件 inode 号的链接，删除文件名就等于删除与之对应的链接。目录文件的字体颜色是蓝色，使用 ls -l 命令查看，第一个字符为"d"（directory）。

这个很容易理解，就是目录，跟windows下的文件夹一个意思，只不过在linux中我们不叫文件夹，而是叫做目录。ls -l 查看第一个属性为 ‘d’.

3）链接文件(link)：链接文件一般指的是一个文件的软连接（或符号链接），使用 ls -l 命令查看，第一个符号为 "l"，文件名为浅蓝色，如下：

ls -l 查看第一个属性为 ‘l’, 类似windows下的快捷方式。

4）设备(device)：　　Linux 中的硬件设备如硬盘、鼠标等也都被表示为文件，即为设备文件。设备文件一般存放在 /dev/ 目录下

​		块设备文件：块设备文件支持以块（block）为单位的访问方式。在 EXT4 文件系统中，一个 block 通常为 4KB 的大小，也就是说每次可以存取 4096（或其整数倍） 个字节的数据。应用程序可以随机访问块设备文件的数据，程序可以自行确定数据的位置，硬盘、软盘等都是块设备。使用 ls -l 命令查看，块设备文件的第一个字符是 "b"（block）。

​		字符设备文件：字符设备文件以字节流的方式进行访问，由字符设备驱动程序来实现这种特性，这通常要用到 open、close、read、write 等系统调用。字符终端、串口和键盘等就是字符设备。另外，由于字符设备文件是以文件流的方式进行访问的，因此可以顺序读取，但通常不支持随机存取。使用 ls -l 命令查看，字符设备文件的第一个字符是 "c"（char）



### 4.2.2、文件权限

**文件的权限：**

　　以普通文件为例，使用 ls -l 命令，可以看到结果的第一列是 **-rwxrwxrwx** 的形式，其中第一个字符 "-" 表示这个文件为普通文件，它也可以是其他的字符，不同的字符代表不同类型的文件。其后的一串字符表明了该文件的权限，其中：

1）r 表明该文件具有可读权限，若该位置为 "-" ，则表明文件不可读；

2）w 表明该文件具有写权限，若该位置为 "-" ，则表明文件不可写；

3）x 表明该文件具有可执行权限，若该位置为 "-" ，则表明文件不具有可执行权限；

4）第一个 rwx 表示该文件的所有者对该文件的权限；第二个 rwx 表示该文件所属组对该文件的权限；第三个 rwx 表示其他用户对该文件的权限。



**目录文件的权限**：

1）r 表明该目录文件具有可读权限，即可以使用 ls 命令查看该目录的存储情况；

2）w 表明该目录文件具有写权限，即可以往该目录下添加、修改、删除文件；

3）x 表明该目录文件具有可执行文件，即可以使用 cd 命令进入到该目录下。

　　可以使用 **chmod** 指令来改变文件的权限。

**创建一个目录：**

　　可以使用 mkdir 命令来创建一个目录文件：

```
mkdir directory
```

**删除一个目录：**

　　可以使用 rmdir 命令来删除一个空目录：

```
rmdir directory
```

　　如果该目录下有其他文件，则可以使用 rm -r 命令来递归删除该目录下的所有文件。需要注意的是，使用该命令将会删除该目录及目录下的所有数据，过程不可逆，需要谨慎使用：

```
rm -r directory
```





**1）软链接**

　　软链接（又称符号链接），使用 **ln -s file file_softlink** 命令可以创建一个文件的软链接文件：

```
ln -s test.txt test_softlink
```

　　软链接相当于给原文件创建了一个快捷方式，如果删除原文件，则对应的软链接文件也会消失。

**2）硬链接**

　　硬链接，相当于给原文件取了个别名，其实两者是同一个文件，删除二者中任何一个，另一个不会消失；对其中任何一个进行更改，另一个的内容也会随之改变，因为这两个本质上是同一个文件，只是名字不同。使用 ls -i 命令查看，可以发现硬链接的两个文件的 inode 号是一样的：

![img](https://img2018.cnblogs.com/blog/765389/201902/765389-20190221163724064-292821250.png)

　　同样的，使用 ln 命令可以创建一个文件的硬链接：

```
ln test.txt test_hardlink
```

## 4.3、命令集合

### ls (列出目录)

在Linux系统当中， ls 命令可能是最常被运行的。

语法：

```
[root@www ~]# ls [-aAdfFhilnrRSt] 目录名称
[root@www ~]# ls [--color={never,auto,always}] 目录名称
[root@www ~]# ls [--full-time] 目录名称
```

选项与参数：

- -a ：全部的文件，连同隐藏文件( 开头为 . 的文件) 一起列出来(常用)
- -d ：仅列出目录本身，而不是列出目录内的文件数据(常用)
- -l ：长数据串列出，包含文件的属性与权限等等数据；(常用)

将家目录下的所有文件列出来(含属性与隐藏档)

```
[root@www ~]# ls -al ~
```

### cd (切换目录)

cd是Change Directory的缩写，这是用来变换工作目录的命令。

语法：

```
 cd [相对路径或绝对路径]
#使用 mkdir 命令创建 runoob 目录
[root@www ~]# mkdir runoob

#使用绝对路径切换到 runoob 目录
[root@www ~]# cd /root/runoob/

#使用相对路径切换到 runoob 目录
[root@www ~]# cd ./runoob/

# 表示回到自己的家目录，亦即是 /root 这个目录
[root@www runoob]# cd ~

# 表示去到目前的上一级目录，亦即是 /root 的上一级目录的意思；
[root@www ~]# cd ..
```

接下来大家多操作几次应该就可以很好的理解 cd 命令的。

### pwd (显示目前所在的目录)

pwd 是 **Print Working Directory** 的缩写，也就是显示目前所在目录的命令。

```
[root@www ~]# pwd [-P]
```

选项与参数：

- **-P** ：显示出确实的路径，而非使用连结 (link) 路径。

实例：单纯显示出目前的工作目录：

```
[root@www ~]# pwd
/root   <== 显示出目录啦～
```

实例显示出实际的工作目录，而非连结档本身的目录名而已。

```
[root@www ~]# cd /var/mail   <==注意，/var/mail是一个连结档
[root@www mail]# pwd
/var/mail         <==列出目前的工作目录
[root@www mail]# pwd -P
/var/spool/mail   <==怎么回事？有没有加 -P 差很多～
[root@www mail]# ls -ld /var/mail
lrwxrwxrwx 1 root root 10 Sep  4 17:54 /var/mail -> spool/mail
# 看到这里应该知道为啥了吧？因为 /var/mail 是连结档，连结到 /var/spool/mail 
# 所以，加上 pwd -P 的选项后，会不以连结档的数据显示，而是显示正确的完整路径啊！
```

### mkdir (创建新目录)

如果想要创建新的目录的话，那么就使用mkdir (make directory)吧。

语法：

```
mkdir [-mp] 目录名称
```

选项与参数：

- -m ：配置文件的权限喔！直接配置，不需要看默认权限 (umask) 的脸色～
- -p ：帮助你直接将所需要的目录(包含上一级目录)递归创建起来！

实例：请到/tmp底下尝试创建数个新目录看看：

```
[root@www ~]# cd /tmp
[root@www tmp]# mkdir test    <==创建一名为 test 的新目录
[root@www tmp]# mkdir test1/test2/test3/test4
mkdir: cannot create directory `test1/test2/test3/test4': 
No such file or directory       <== 没办法直接创建此目录啊！
[root@www tmp]# mkdir -p test1/test2/test3/test4
```

加了这个 -p 的选项，可以自行帮你创建多层目录！

实例：创建权限为 **rwx--x--x** 的目录。

```
[root@www tmp]# mkdir -m 711 test2
[root@www tmp]# ls -l
drwxr-xr-x  3 root  root 4096 Jul 18 12:50 test
drwxr-xr-x  3 root  root 4096 Jul 18 12:53 test1
drwx--x--x  2 root  root 4096 Jul 18 12:54 test2
```

上面的权限部分，如果没有加上 -m 来强制配置属性，系统会使用默认属性。

如果我们使用 -m ，如上例我们给予 -m 711 来给予新的目录 drwx--x--x 的权限。

### rmdir (删除空的目录)

语法：

```
 rmdir [-p] 目录名称
```

选项与参数：

- **-p ：**连同上一级『空的』目录也一起删除

删除 runoob 目录

```
[root@www tmp]# rmdir runoob/
```

将 mkdir 实例中创建的目录(/tmp 底下)删除掉！

```
[root@www tmp]# ls -l   <==看看有多少目录存在？
drwxr-xr-x  3 root  root 4096 Jul 18 12:50 test
drwxr-xr-x  3 root  root 4096 Jul 18 12:53 test1
drwx--x--x  2 root  root 4096 Jul 18 12:54 test2
[root@www tmp]# rmdir test   <==可直接删除掉，没问题
[root@www tmp]# rmdir test1  <==因为尚有内容，所以无法删除！
rmdir: `test1': Directory not empty
[root@www tmp]# rmdir -p test1/test2/test3/test4
[root@www tmp]# ls -l        <==您看看，底下的输出中test与test1不见了！
drwx--x--x  2 root  root 4096 Jul 18 12:54 test2
```

利用 -p 这个选项，立刻就可以将 test1/test2/test3/test4 一次删除。

不过要注意的是，这个 rmdir 仅能删除空的目录，你可以使用 rm 命令来删除非空目录。

### cp (复制文件或目录)

cp 即拷贝文件和目录。

语法:

```
[root@www ~]# cp [-adfilprsu] 来源档(source) 目标档(destination)
[root@www ~]# cp [options] source1 source2 source3 .... directory
```

选项与参数：

- **-a：**相当於 -pdr 的意思，至於 pdr 请参考下列说明；(常用)
- **-d：**若来源档为连结档的属性(link file)，则复制连结档属性而非文件本身；
- **-f：**为强制(force)的意思，若目标文件已经存在且无法开启，则移除后再尝试一次；
- **-i：**若目标档(destination)已经存在时，在覆盖时会先询问动作的进行(常用)
- **-l：**进行硬式连结(hard link)的连结档创建，而非复制文件本身；
- **-p：**连同文件的属性一起复制过去，而非使用默认属性(备份常用)；
- **-r：**递归持续复制，用於目录的复制行为；(常用)
- **-s：**复制成为符号连结档 (symbolic link)，亦即『捷径』文件；
- **-u：**若 destination 比 source 旧才升级 destination ！

用 root 身份，将 root 目录下的 .bashrc 复制到 /tmp 下，并命名为 bashrc

```
[root@www ~]# cp ~/.bashrc /tmp/bashrc
[root@www ~]# cp -i ~/.bashrc /tmp/bashrc
cp: overwrite `/tmp/bashrc'? n  <==n不覆盖，y为覆盖
```

### rm (移除文件或目录)

语法：

```
 rm [-fir] 文件或目录
```

选项与参数：

- -f ：就是 force 的意思，忽略不存在的文件，不会出现警告信息；
- -i ：互动模式，在删除前会询问使用者是否动作
- -r ：递归删除啊！最常用在目录的删除了！这是非常危险的选项！！！
- 

将刚刚在 cp 的实例中创建的 bashrc 删除掉！

```
[root@www tmp]# rm -i bashrc
rm: remove regular file `bashrc'? y
```

如果加上 -i 的选项就会主动询问喔，避免你删除到错误的档名！

### mv (移动文件与目录，或修改名称)

语法：

```
[root@www ~]# mv [-fiu] source destination
[root@www ~]# mv [options] source1 source2 source3 .... directory
```

选项与参数：

- -f ：force 强制的意思，如果目标文件已经存在，不会询问而直接覆盖；
- -i ：若目标文件 (destination) 已经存在时，就会询问是否覆盖！
- -u ：若目标文件已经存在，且 source 比较新，才会升级 (update)

复制一文件，创建一目录，将文件移动到目录中

```
[root@www ~]# cd /tmp
[root@www tmp]# cp ~/.bashrc bashrc
[root@www tmp]# mkdir mvtest
[root@www tmp]# mv bashrc mvtest
```

将某个文件移动到某个目录去，就是这样做！

将刚刚的目录名称更名为 mvtest2

```
[root@www tmp]# mv mvtest mvtest2
```



### cat

由第一行开始显示文件内容

语法：

```
cat [-AbEnTv]
```

选项与参数：

- -A ：相当於 -vET 的整合选项，可列出一些特殊字符而不是空白而已；
- -b ：列出行号，仅针对非空白行做行号显示，空白行不标行号！
- -E ：将结尾的断行字节 $ 显示出来；
- -n ：列印出行号，连同空白行也会有行号，与 -b 的选项不同；
- -T ：将 [tab] 按键以 ^I 显示出来；
- -v ：列出一些看不出来的特殊字符

检看 /etc/issue 这个文件的内容：

```
[root@www ~]# cat /etc/issue
CentOS release 6.4 (Final)
Kernel \r on an \m
```



## 参考资料

[1] http://www.pathname.com/fhs/



